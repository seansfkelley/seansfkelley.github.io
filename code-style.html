<!DOCTYPE html>
<html><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>My Code Style | fiddlybits</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="My Code Style" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://blog.sea.nkelley.me/code-style" />
<meta property="og:url" content="https://blog.sea.nkelley.me/code-style" />
<meta property="og:site_name" content="fiddlybits" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-11-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="My Code Style" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-11-04T00:00:00+00:00","datePublished":"2025-11-04T00:00:00+00:00","headline":"My Code Style","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.sea.nkelley.me/code-style"},"url":"https://blog.sea.nkelley.me/code-style"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/style.css">
  <link type="application/atom+xml" rel="alternate" href="https://blog.sea.nkelley.me/feed.xml" title="fiddlybits" /></head>
<body data-theme="auto" data-unit="imperial"><header class="site-header">
  <div class="centering-wrapper">
    <a class="site-title" href="/">fiddlybits</a>
    <span class="site-controls">
      <a href="/tag">tags</a>
      &nbsp;•&nbsp;
      <a href="https://github.com/seansfkelley">github</a>
      &nbsp;•&nbsp;
      <a href="/feed.xml">rss</a>
      <!-- Only show theme switcher if js is enabled: hide by default. -->
      <span id="theme-switcher-wrapper" style="display: none;">
        &nbsp;•&nbsp;
        <a href="#" id="theme-switcher"></a>
      </span>
    </span>
  </div>
</header>
<main class="centering-wrapper">
      <article class="post">
  <header class="post-header">
    <h1 class="post-title">My Code Style</h1>
    <h3 class="post-subtitle"></h3>
  </header><ul id="markdown-toc">
  <li><a href="#what-this-is" id="markdown-toc-what-this-is">What This Is</a>    <ul>
      <li><a href="#use-engineering-judgement" id="markdown-toc-use-engineering-judgement">Use Engineering Judgement</a></li>
    </ul>
  </li>
  <li><a href="#the-underlying-philosophy" id="markdown-toc-the-underlying-philosophy">The Underlying Philosophy</a>    <ul>
      <li><a href="#data-first-business-logic-second" id="markdown-toc-data-first-business-logic-second">Data First, Business Logic Second</a></li>
      <li><a href="#tools-not-process" id="markdown-toc-tools-not-process">Tools, Not Process</a></li>
      <li><a href="#strive-to-explain-intent" id="markdown-toc-strive-to-explain-intent">Strive to Explain Intent</a></li>
      <li><a href="#write-quality-code-the-first-time" id="markdown-toc-write-quality-code-the-first-time">Write Quality Code the First Time</a></li>
      <li><a href="#perfect-is-the-enemy-of-good" id="markdown-toc-perfect-is-the-enemy-of-good">Perfect is the Enemy of Good</a></li>
    </ul>
  </li>
  <li><a href="#superficial-code-style" id="markdown-toc-superficial-code-style">Superficial Code Style</a>    <ul>
      <li><a href="#consistency" id="markdown-toc-consistency">Consistency</a></li>
      <li><a href="#automated-formatters" id="markdown-toc-automated-formatters">Automated Formatters</a>        <ul>
          <li><a href="#exception-multi-line-regexes" id="markdown-toc-exception-multi-line-regexes">Exception: Multi-line Regexes</a></li>
          <li><a href="#exception-cross-language-byte-identical-find-replace" id="markdown-toc-exception-cross-language-byte-identical-find-replace">Exception: Cross-language, Byte-identical Find-replace</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#comments" id="markdown-toc-comments">Comments</a>    <ul>
      <li><a href="#when-to-use-comments" id="markdown-toc-when-to-use-comments">When to Use Comments</a></li>
      <li><a href="#examples-of-useful-comments" id="markdown-toc-examples-of-useful-comments">Examples of Useful Comments</a></li>
      <li><a href="#examples-of-extraneous-comments" id="markdown-toc-examples-of-extraneous-comments">Examples of Extraneous Comments</a></li>
    </ul>
  </li>
  <li><a href="#naming" id="markdown-toc-naming">Naming</a>    <ul>
      <li><a href="#names-should-be-at-least-two-words" id="markdown-toc-names-should-be-at-least-two-words">Names Should Be At Least Two Words</a></li>
      <li><a href="#use-standard-vocabulary" id="markdown-toc-use-standard-vocabulary">Use Standard Vocabulary</a></li>
      <li><a href="#avoid-most-abbreviations" id="markdown-toc-avoid-most-abbreviations">Avoid Most Abbreviations</a></li>
      <li><a href="#initialisms-are-words" id="markdown-toc-initialisms-are-words">Initialisms are Words</a></li>
      <li><a href="#functions-should-be-verb-y" id="markdown-toc-functions-should-be-verb-y">Functions Should be Verb-y</a></li>
      <li><a href="#values-should-be-noun-y" id="markdown-toc-values-should-be-noun-y">Values Should be Noun-y</a></li>
      <li><a href="#exception-booleans" id="markdown-toc-exception-booleans">Exception: Booleans</a></li>
    </ul>
  </li>
  <li><a href="#managing-state" id="markdown-toc-managing-state">Managing State</a>    <ul>
      <li><a href="#control-flow" id="markdown-toc-control-flow">Control Flow</a>        <ul>
          <li><a href="#match-if-with-else-whenever-possible" id="markdown-toc-match-if-with-else-whenever-possible">Match <code class="language-plaintext highlighter-rouge">if</code> with <code class="language-plaintext highlighter-rouge">else</code> Whenever Possible</a></li>
          <li><a href="#use-assertions-to-supplement-types" id="markdown-toc-use-assertions-to-supplement-types">Use Assertions to Supplement Types</a></li>
          <li><a href="#combine-and-eliminate-cases" id="markdown-toc-combine-and-eliminate-cases">Combine (and Eliminate) Cases</a></li>
          <li><a href="#explicit-alternatives" id="markdown-toc-explicit-alternatives">Explicit Alternatives</a></li>
          <li><a href="#branch-in-the-right-place-or-inline-and-factor-out" id="markdown-toc-branch-in-the-right-place-or-inline-and-factor-out">Branch in the Right Place (or: Inline <em>and</em> Factor Out)</a></li>
          <li><a href="#functions-decide-or-act-not-both" id="markdown-toc-functions-decide-or-act-not-both">Functions Decide <em>or</em> Act, Not Both</a></li>
          <li><a href="#use-exhaustiveness-checking" id="markdown-toc-use-exhaustiveness-checking">Use Exhaustiveness Checking</a></li>
        </ul>
      </li>
      <li><a href="#variable-scope" id="markdown-toc-variable-scope">Variable Scope</a>        <ul>
          <li><a href="#dont-store-derived-values" id="markdown-toc-dont-store-derived-values">Don’t Store Derived Values</a></li>
          <li><a href="#defer-declarations-as-late-as-possible" id="markdown-toc-defer-declarations-as-late-as-possible">Defer Declarations as Late as Possible</a></li>
          <li><a href="#shorten-lifetimes-with-blocks-or-one-use-functions" id="markdown-toc-shorten-lifetimes-with-blocks-or-one-use-functions">Shorten Lifetimes with Blocks (or One-use Functions)</a></li>
        </ul>
      </li>
      <li><a href="#mutation-and-side-effects" id="markdown-toc-mutation-and-side-effects">Mutation and Side Effects</a>        <ul>
          <li><a href="#prefer-constant-variables" id="markdown-toc-prefer-constant-variables">Prefer Constant Variables</a></li>
          <li><a href="#minimize-mutations-blast-radius" id="markdown-toc-minimize-mutations-blast-radius">Minimize Mutations’ Blast Radius</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#types" id="markdown-toc-types">Types</a>    <ul>
      <li><a href="#enumerations-v-booleans" id="markdown-toc-enumerations-v-booleans">Enumerations v. Booleans</a></li>
      <li><a href="#keyword-arguments" id="markdown-toc-keyword-arguments">Keyword Arguments</a></li>
    </ul>
  </li>
  <li><a href="#debuggability-and-observability" id="markdown-toc-debuggability-and-observability">Debuggability and Observability</a>    <ul>
      <li><a href="#string-literal-log-lines" id="markdown-toc-string-literal-log-lines">String Literal Log Lines</a></li>
    </ul>
  </li>
  <li><a href="#version-control-ie-git" id="markdown-toc-version-control-ie-git">Version Control (i.e. Git)</a>    <ul>
      <li><a href="#squash-v-rebase-v-merge-into-mainline" id="markdown-toc-squash-v-rebase-v-merge-into-mainline">Squash v. Rebase v. Merge into Mainline</a></li>
      <li><a href="#force-pushingrebasing-feature-branches" id="markdown-toc-force-pushingrebasing-feature-branches">Force-pushing/Rebasing Feature Branches</a></li>
    </ul>
  </li>
</ul>
<h1 id="what-this-is">
  
  
    <a href="#what-this-is" class="anchor-heading">#</a>What This Is
  
  
</h1>
    

<p>This is my code style. “Style” here means how concepts are represented, structured and explained to the reader, not where I put the curly brackets.</p>

<p>There is no objectively correct answer regarding this kind code of style, but this document outlines the main pillars of mine. As such, they are also the things I look for in code reviews. I refer to this document when doing code reviews (which is probably why you’re here).</p>

<p>Yes, this document is very dry.</p>
<h2 id="use-engineering-judgement">
  
  
    <a href="#use-engineering-judgement" class="anchor-heading">#</a>Use Engineering Judgement
  
  
</h2>
    

<p><strong>None of these points on style are hard and fast.</strong> They overlap and sometimes trade off. Ultimately, code needs to serve an end, and sometimes that requires compromising on principles.</p>
<h1 id="the-underlying-philosophy">
  
  
    <a href="#the-underlying-philosophy" class="anchor-heading">#</a>The Underlying Philosophy
  
  
</h1>
    

<p>Before wading into the crossfire on when and how to write comments, I want to outline some more abstract concepts that are reflected in the more-specific opinions that follow.</p>

<p>The philosophical points below are idealistic and can’t always be achieved within in the constraints of any given code review, but I strive for them when possible.</p>
<h2 id="data-first-business-logic-second">
  
  
    <a href="#data-first-business-logic-second" class="anchor-heading">#</a>Data First, Business Logic Second
  
  
</h2>
    

<blockquote>
  <p>Show me your flowcharts [algorithms] and conceal your tables [data model], and I shall continue to be mystified. Show me your tables, and I won’t usually need your flowcharts; they’ll be obvious.</p>

  <p>– Fred Brooks, Mythical Man Month</p>
</blockquote>

<p>If you don’t know what values you’re operating with, you can’t do anything with them. The names, types and lifetimes of values, as well as the interaction between them, should be the primary driver for how code is structured. Programs are ultimately machines for processing inputs into outputs, so build around those inputs and outputs and any necessary intermediates.</p>
<h2 id="tools-not-process">
  
  
    <a href="#tools-not-process" class="anchor-heading">#</a>Tools, Not Process
  
  
</h2>
    

<p><em>a.k.a.</em> <strong>Solve Problems Once</strong></p>

<blockquote>
  <p>If you haven’t automated your last-year self out of a job, you aren’t learning.</p>

  <p>– An ex-manager of mine (paraphrased)</p>
</blockquote>

<p>Don’t do manually what can be done automatically. Put the work in now to find, configure or build the right tool for the job, then never think of that problem again. Don’t make anyone else have to think about the problem, either, if you can avoid it: documentation is no replacement for automation.</p>
<h2 id="strive-to-explain-intent">
  
  
    <a href="#strive-to-explain-intent" class="anchor-heading">#</a>Strive to Explain Intent
  
  
</h2>
    

<p>Code is an unambiguous, precise specification of behavior, so treat it like one. Computers don’t need to have code explained to them, but people do. Write your code so it’s clear what you <em>intend</em> to have happen, so that when it inevitably doesn’t, someone besides you – or just your future self – can understand how to fix it properly.</p>

<p>This supersedes the oft-cited “don’t be clever”: removing or avoiding cleverness is common result of striving to explain intent.</p>
<h2 id="write-quality-code-the-first-time">
  
  
    <a href="#write-quality-code-the-first-time" class="anchor-heading">#</a>Write Quality Code the First Time
  
  
</h2>
    

<p>Spend the time now to save the time later.</p>

<p>If I sent you this page, you aren’t the first employee of an underfunded startup in do-or-die mode. Every corner you cut will be paid for dozens of times over with every reader of your code. Bike shed your names before you merge. Your prototype <em>will</em> end up in production, so give it a little more thought.</p>
<h2 id="perfect-is-the-enemy-of-good">
  
  
    <a href="#perfect-is-the-enemy-of-good" class="anchor-heading">#</a>Perfect is the Enemy of Good
  
  
</h2>
    

<p>The standard phrasing of this – “don’t let perfect be the enemy of good” – isn’t assertive enough for my tastes. You are in control. Misguidedly seeking perfection isn’t happening <em>to</em> you.</p>

<p>What’s usually missed when this is cited is that (1) it takes a lot experience to learn where the line is and (2) where you draw the line is probably not exactly where I do. Keep this in mind and learn to be a little flexible without compromising on the principles that truly make a difference.</p>
<h1 id="superficial-code-style">
  
  
    <a href="#superficial-code-style" class="anchor-heading">#</a>Superficial Code Style
  
  
</h1>
    

<p>A quick diversion into what “style” usually means to state some core high-level principles. We’re still not talking about curly brackets.</p>
<h2 id="consistency">
  
  
    <a href="#consistency" class="anchor-heading">#</a>Consistency
  
  
</h2>
    

<p>Whoever said “consistency is the hobgoblin of little minds” never had to work in a multi-million line codebase. Rather, it is a tool of the practitioner, not a fetish of the theoretician.</p>

<p>Consistency is how you can do massive code reviews and not trip over every line (such reviews <em>do</em> happen: sorry idealists).</p>

<p>Consistency enables quick and dirty regexes when you can’t rely on types to find usages.</p>

<p>Consistency is why I can use inconsistency to draw attention to unavoiably peculiar code.</p>

<p>Consistency is how I stay sane.</p>
<h2 id="automated-formatters">
  
  
    <a href="#automated-formatters" class="anchor-heading">#</a>Automated Formatters
  
  
</h2>
    

<p>Automated formatters like Prettier and Black are to be considered correct, <em>even in weird edge cases</em>. When there is a conflict on style, the automated formatter is correct. Modern bikesheds come pre-painted. Spend your valuable time elsewhere.</p>
<h3 id="exception-multi-line-regexes">
  
  
    <a href="#exception-multi-line-regexes" class="anchor-heading">#</a>Exception: Multi-line Regexes
  
  
</h3>
    

<p>Regexes are always hard to read. Unfortunately, long regexes are sometimes necessary. In the case where you cannot comment on a long nasty regex by pointing to <a href="https://stackoverflow.com/questions/201323/how-to-validate-an-email-address-using-a-regular-expression">some documentation</a> (or your language doesn’t have <a href="https://developer.apple.com/documentation/regexbuilder"><code class="language-plaintext highlighter-rouge">RegexBuilder</code></a> <em>*swoon*</em>), it’s probably a good idea to break your regex up onto multiple lines and explain what each piece is doing.</p>

<p>In this case, automated formatters are likely to wreck your significant indentation or inline sections that were separated for clarity and should therefore be disabled if they do not understand your multi-line regex.</p>
<h3 id="exception-cross-language-byte-identical-find-replace">
  
  
    <a href="#exception-cross-language-byte-identical-find-replace" class="anchor-heading">#</a>Exception: Cross-language, Byte-identical Find-replace
  
  
</h3>
    

<p>Some languages have syntactic overlap, but often have differing formatting rules. In the <em>exceptionally rare</em><sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> circumstances where it’s valuable to have the same sequence of characters across two languages, disable the formatter for that block.</p>
<h1 id="comments">
  
  
    <a href="#comments" class="anchor-heading">#</a>Comments
  
  
</h1>
    

<p>Comments should be used to explain <em>why</em>, not <em>what</em> and definitely never <em>how</em>.</p>

<p>This section refers only to regular comments, not doc comments, which serve an entirely different purpose.</p>
<h2 id="when-to-use-comments">
  
  
    <a href="#when-to-use-comments" class="anchor-heading">#</a>When to Use Comments
  
  
</h2>
    

<p>Sparingly.</p>

<p>Code should strive to be self-explanatory. It is a precise specification of behavior covering both the <em>what</em> and the <em>how</em> by definition, and usually the <em>why</em> by virtue of naming, organization and common contextual knowledge (i.e. what the whole program is designed to do).</p>

<p>Comments are suitable only when there is no reasonable naming or organization of the code that can address the <em>why</em>. Explaining <em>what</em> or <em>how</em> risks the comment becoming misleading in the future, since comments are not checked for consistency or sanity by any automated tool. Misleading comments are worse than no comments. Don’t litter.</p>
<h2 id="examples-of-useful-comments">
  
  
    <a href="#examples-of-useful-comments" class="anchor-heading">#</a>Examples of Useful Comments
  
  
</h2>
    

<p>Useful comments are those that explain necessary but unusual code constructs, such as those that:</p>

<ul>
  <li>are hacks</li>
  <li>have magic constants</li>
  <li>have non-obvious side-effects</li>
  <li>work around weird APIs</li>
  <li>satisfy some automated tool, such as a linter</li>
  <li>intentionally preserve style for compatibility or historical reasons</li>
</ul>
<h2 id="examples-of-extraneous-comments">
  
  
    <a href="#examples-of-extraneous-comments" class="anchor-heading">#</a>Examples of Extraneous Comments
  
  
</h2>
    

<p>Common occurences of unjustifiable comments are those that:</p>

<ul>
  <li>explain an inline constant
    <ul>
      <li>Instead, hoist it to a SHOUTING_CASE value, and if it still needs explanation, then consider a comment.</li>
      <li>In the specific cases of numbers or strings, it can sometimes be useful to break the derivation of the value out into steps for emphasis, e.g., <code class="language-plaintext highlighter-rouge">const FIFTEEN_MINUTES = 15 * 60 * 1000;</code></li>
    </ul>
  </li>
  <li>explain a boolean parameter at a call site
    <ul>
      <li>Instead, consider <a href="#enumerations-v-booleans">rewriting the called function to accept an enumeration</a> (or keyword arguments), forcing the call site to be clearer.</li>
    </ul>
  </li>
  <li>restate adjacent code in prose
    <ul>
      <li>Instead, delete the comment.</li>
    </ul>
  </li>
</ul>
<h1 id="naming">
  
  
    <a href="#naming" class="anchor-heading">#</a>Naming
  
  
</h1>
    

<p>Good names go a long way towards pre-empting reader questions and code comments. Following certain conventions makes the code-reading experience smoother by not surprising your reader. They can even speed up code-writing by forcing you to stop and think <em>“What exactly am I trying to express here?”</em> rather than barging ahead into a dead end with whatever control flow first comes to mind.</p>
<h2 id="names-should-be-at-least-two-words">
  
  
    <a href="#names-should-be-at-least-two-words" class="anchor-heading">#</a>Names Should Be At Least Two Words
  
  
</h2>
    

<p>The clarity of any given name goes <em>way</em> up from one word to two. Look around you: how many tables, chairs, windows, devices, utensils, tools, vehicles or people can you uniquely identify in your current “scope” by adding just one adjective or locator to, well, “table”, “chair”, “window”, etc.? When in doubt, overshare.</p>

<p><strong>Exception:</strong> in highly-generic contexts, you might not be able to come up with a better name than <code class="language-plaintext highlighter-rouge">row</code> or <code class="language-plaintext highlighter-rouge">data</code>.</p>

<p><strong>Exception:</strong> in inline contexts, shorter names can improve clarity by reducing repetitive noise, such as in e.g. <code class="language-plaintext highlighter-rouge">all_entries.filter(e =&gt; e.enabled)</code>.</p>
<h2 id="use-standard-vocabulary">
  
  
    <a href="#use-standard-vocabulary" class="anchor-heading">#</a>Use Standard Vocabulary
  
  
</h2>
    

<p>Prefer well-known words like “get” rather than synonyms like “obtain”. Use boring, clear names almost all the time. While fun, your code should require neither a dictionary nor a thesaurus. Unusual names suggest unusual behavior, so don’t be misleading.</p>

<p><strong>Exception:</strong> don’t be afraid to use jargon when it’s suitable. If you’re overloading the subtraction operator, it’s okay, even preferred, to say “subtrahend”.</p>

<p><strong>Exception:</strong> if you want to define something new with <em>very particular and maybe unusual</em> semantics, it can be useful to choose a word that doesn’t have baggage and define it to mean what you want. Consider leaving a comment.</p>
<h2 id="avoid-most-abbreviations">
  
  
    <a href="#avoid-most-abbreviations" class="anchor-heading">#</a>Avoid Most Abbreviations
  
  
</h2>
    

<p>Your editor has autocomplete and your ability to parse streams of letters is not the bottleneck to your understanding. Don’t be afraid of <em>authentication</em>, <em>rasterization</em> or even <em>canonicalization</em>.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup> It’s better to spend the extra milliseconds now and avoid ambiguity and confusion later.</p>

<p>If you really want to abbreviate things, only do it if they are at least one of:</p>
<ul>
  <li><em>common in English</em>, such as “appt” for “appointment”</li>
  <li><em>obvious in context</em>, such as referring to the <code class="language-plaintext highlighter-rouge">mag</code> of a <code class="language-plaintext highlighter-rouge">Vector3</code></li>
  <li><em>idiomatic</em>, such as looping with <code class="language-plaintext highlighter-rouge">i</code> and <code class="language-plaintext highlighter-rouge">j</code></li>
</ul>
<h2 id="initialisms-are-words">
  
  
    <a href="#initialisms-are-words" class="anchor-heading">#</a>Initialisms are Words
  
  
</h2>
    

<p>Treat initialisms and acronyms as words for the purposes of casing. Don’t write <code class="language-plaintext highlighter-rouge">AWSIAMJSONParser</code>; write <code class="language-plaintext highlighter-rouge">AwsIamJsonParser</code>. I hope this example is self-explanatory. (If not, how about <code class="language-plaintext highlighter-rouge">JPEGEXIFGPSLookup</code> or <code class="language-plaintext highlighter-rouge">XMLDTDURIResolver</code>?)</p>

<p>As a bonus, some tools (e.g. IntelliJ) have built-in fuzzy-search behavior that returns higher-quality results when initialisms are capitalized as words.</p>
<h2 id="functions-should-be-verb-y">
  
  
    <a href="#functions-should-be-verb-y" class="anchor-heading">#</a>Functions Should be Verb-y
  
  
</h2>
    

<p>Action words like “get”, “commit” or “write” communicate that a function <em>performs an action</em>. This re-emphasizes the distinction between code and data (hi, Lispers!) along with your language’s syntax and the syntax highlighter, and helps frame the naming question in useful terms: what does this function <em>do</em>?</p>
<h2 id="values-should-be-noun-y">
  
  
    <a href="#values-should-be-noun-y" class="anchor-heading">#</a>Values Should be Noun-y
  
  
</h2>
    

<p>Variables and parameters should have noun-y names that communicate <em>what</em> role they play, but rarely <em>how</em>. Avoid including the type of the variable in its name, which may change and thereby confuse more than help. Like functions being verb-y, this emphasizes a distinction and helpfully frames the question to aid in picking a good name.</p>
<h2 id="exception-booleans">
  
  
    <a href="#exception-booleans" class="anchor-heading">#</a>Exception: Booleans
  
  
</h2>
    

<p>Empirically, boolean functions and values benefit from some special considerations. They should be phrased…</p>
<ul>
  <li><em>declaratively</em>, like <code class="language-plaintext highlighter-rouge">is_something()</code> rather than <code class="language-plaintext highlighter-rouge">check_if_something()</code>.</li>
  <li><em>positively</em>, e.g. <code class="language-plaintext highlighter-rouge">is_something_enabled</code>, not negatively, e.g., <code class="language-plaintext highlighter-rouge">is_something_disabled</code>. This reduces indirection by one level and helps avoid unnecessary double negatives.</li>
</ul>

<p>Consider <a href="#enumerations-v-booleans">replacing boolean values by a two-state enumeration</a>.</p>
<h1 id="managing-state">
  
  
    <a href="#managing-state" class="anchor-heading">#</a>Managing State
  
  
</h1>
    

<p>In most run-of-the-mill programming, the complexity you and your reader have to deal with comes from having to track three things:</p>

<ul>
  <li><strong>control flow</strong> paths, in order to understand all the possible paths through a piece of code</li>
  <li><strong>variable scopes</strong>, in order to understand what values are currently in play and could interact with each other</li>
  <li><strong>mutations</strong> made to a value after it is initially declared, changing how it may interact with other values or control flow constructs</li>
</ul>

<p>Designing your code in order to reduce the size of the state space introduced by these three things can significantly reduce the surface area for bugs and make the code easier to both read and write.</p>

<p>All three of these have overlap with each other and with <a href="#types">types</a>, so I have tried to assign each pattern to the context it interacts with the most.</p>
<h2 id="control-flow">
  
  
    <a href="#control-flow" class="anchor-heading">#</a>Control Flow
  
  
</h2>
    

<p>Reduce the number of possible paths control can take through a given piece of code (the <a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity">cyclomatic complexity</a>). Ideally, this means eliminating branches entirely.</p>
<h3 id="match-if-with-else-whenever-possible">
  
  
    <a href="#match-if-with-else-whenever-possible" class="anchor-heading">#</a>Match <code class="language-plaintext highlighter-rouge">if</code> with <code class="language-plaintext highlighter-rouge">else</code> Whenever Possible
  
  
</h3>
    

<p><code class="language-plaintext highlighter-rouge">if</code> blocks without <code class="language-plaintext highlighter-rouge">else</code>s often look like a mistake. The entire rest of the scope is still controlled by the <code class="language-plaintext highlighter-rouge">if</code>, but implicitly. If you must use a standalone <code class="language-plaintext highlighter-rouge">if</code>, spend the space saying <code class="language-plaintext highlighter-rouge">else { /* noop */ }</code> so there is no doubt. Fall-through in <code class="language-plaintext highlighter-rouge">switch</code> is widely disliked and usually only permitted with an explanation or at least acknowledgement; this is little different.</p>

<p>Many <code class="language-plaintext highlighter-rouge">if</code>s-without-<code class="language-plaintext highlighter-rouge">else</code>s are early returns. If these are grouped at the top of a function, they are permissible, but they will often be better expressed by one of the constructs described in the next sections, such as <a href="#use-assertions-to-supplement-types">assertions</a> or <a href="#combine-and-eliminate-cases">eliminating redundant cases</a>.</p>

<p>Early returns anywhere but at the top of a function are usually more surprising than helpful, and should be avoided if the function is more than a loop or two.</p>

<p>Avoiding lone <code class="language-plaintext highlighter-rouge">if</code>s has the added benefit of being able to more reliably use indentation as a reminder and emphasis for which statements are subject to which control flow.</p>
<h3 id="use-assertions-to-supplement-types">
  
  
    <a href="#use-assertions-to-supplement-types" class="anchor-heading">#</a>Use Assertions to Supplement Types
  
  
</h3>
    

<p>Not all valid inputs can be expressed in the type system. Assertions are a clear and compact expression of those preconditions which cannot be. They should be phrased positively – “this must be true to continue” not “if this is not true, stop” – and are necessarily declarative in style.</p>

<p>Standalone <code class="language-plaintext highlighter-rouge">if</code>s whose body is a <code class="language-plaintext highlighter-rouge">throw</code>/<code class="language-plaintext highlighter-rouge">raise</code> are assertions in disguise, but phrased in reverse and introducing additional unnecessary scopes.</p>
<h3 id="combine-and-eliminate-cases">
  
  
    <a href="#combine-and-eliminate-cases" class="anchor-heading">#</a>Combine (and Eliminate) Cases
  
  
</h3>
    

<p>All techniques for eliminating branches boil down to identifying cases which appear distinct, but are not. Essentially distinct things often manifest as distinct types, and cannot be handled the same way. If you have multiple cases handling values of the same type, look closer: the cases may be more similar than they first appear. Finding a way to combine them might reveal an underlying truth and a correspondingly more elegant solution.</p>

<p>A very common case of unnecessarily distinct cases is nullable collection types. Is a null array a meaningfully distinct thing from an empty one? Usually, not: in both cases, you are going to do zero iterations. Use an empty array, and unconditionally iterate, instead of null checking.</p>
<h3 id="explicit-alternatives">
  
  
    <a href="#explicit-alternatives" class="anchor-heading">#</a>Explicit Alternatives
  
  
</h3>
    

<p>If one branch being hit means that other branches cannot be, represent that explicitly.</p>

<p>A series of three independent <code class="language-plaintext highlighter-rouge">if</code>s in a row doing is-instance checks will not all trigger for a given value, but at a skim (and perhaps without strong compiler support) this may not be obvious. Three <code class="language-plaintext highlighter-rouge">if</code>s represent 8 possible paths. By chaining <code class="language-plaintext highlighter-rouge">if</code>s into <code class="language-plaintext highlighter-rouge">else if</code>s, you can reduce the number of paths in this example to 3 or 4 (depending on if the last case is a catch-all or not).</p>

<p>This technique can often be used to great effect inside loop bodies that would otherwise have to be written with <code class="language-plaintext highlighter-rouge">break</code> or <code class="language-plaintext highlighter-rouge">continue</code>.</p>
<h3 id="branch-in-the-right-place-or-inline-and-factor-out">
  
  
    <a href="#branch-in-the-right-place-or-inline-and-factor-out" class="anchor-heading">#</a>Branch in the Right Place (or: Inline <em>and</em> Factor Out)
  
  
</h3>
    

<p>Moving a branch higher or lower in the control flow can make a huge difference.</p>

<p>In an extreme case, consider the difference between a set of related methods (say, some <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>) that can handle two kinds of entities. You would almost certainly rather have eight methods bundled into two sets of four (two entites times four CRUD methods), than four methods, each containing one branch per entity type.</p>

<p>This can go the other way, too: sometimes readability is improved if you drop an entire <code class="language-plaintext highlighter-rouge">if</code>-<code class="language-plaintext highlighter-rouge">else</code> construct and replace it with a single ternary, buried deep in some otherwise-consistent expression.</p>

<p>In both cases, the goal is to find that crossover point that minimizes both the number of branches, and the number of <em>kinds</em> of branches (or things that are being branched on).</p>

<p>When considering functions specifically, this manifests as the decision to inline or factor out a function body. Inlining can eliminate redundancy such as large parameter sets, whereas factoring out can reduce variable scopes, and both can eliminate control flow redundancy in surrounding code.</p>
<h3 id="functions-decide-or-act-not-both">
  
  
    <a href="#functions-decide-or-act-not-both" class="anchor-heading">#</a>Functions Decide <em>or</em> Act, Not Both
  
  
</h3>
    

<p>One generally thinks of a function as code that effects a change to something, but oftentimes the complexity instead comes in <em>choosing</em> which change to make. Unless one or both of “decide” and “act” are simple, split them into separate functions, perhaps even one-use functions. This almost always yields a very clear separation of concerns that can be effectively tested and might enable some deduplication (e.g. multiple decisions that end up acting the same).</p>

<p>You may have to introduce a new type if the decision cannot be represented as a primitive type. This is often a blessing in disguise; this new type will likely make it easier to identify which cases are meaningfully distinct and may point the way to a simpler implementation of either or both of the “decide” or “act” phases.</p>

<p>In rare cases, making this change and noticing that many decisions boil down to the same act with tiny variations can lead to noticing that <em>all</em> decisions boil down to the same act, which removes the “decide” part entirely.</p>
<h3 id="use-exhaustiveness-checking">
  
  
    <a href="#use-exhaustiveness-checking" class="anchor-heading">#</a>Use Exhaustiveness Checking
  
  
</h3>
    

<p>Instead of carefully inspecting whether every input type has as corresponding branch, make the type checker do it. Many languages have first-class exhaustiveness checking (<a href="https://gibbok.github.io/typescript-book/book/exhaustiveness-checking/">1</a>, <a href="https://rustc-dev-guide.rust-lang.org/pat-exhaustive-checking.html">2</a>, <a href="https://docs.swift.org/swift-book/documentation/the-swift-programming-language/controlflow/#Switch">3</a>…), so when you modify your type, which is the source of truth for what your code is capable of, the language ensures all usages are up-to-date.</p>

<p>Exhaustiveness checking is so useful that I routinely reshape or augment existing types specifically so that they can fit the language’s preferred style for it. This falls under “solve all problems once”. Yes, I am an admitted <a href="https://brooker.co.za/blog/2020/06/23/code.html">type system maximalist</a>.</p>
<h2 id="variable-scope">
  
  
    <a href="#variable-scope" class="anchor-heading">#</a>Variable Scope
  
  
</h2>
    

<p>Try to reduce the number of ways variables could potentially interact with each other. Ideally, this means eliminating a variable entirely.</p>

<p>Every declared variable is another item to keep track of. The larger the scope of the variable, the longer one has to remember what the value is for and what changes, if any, the value has undergone since its declaration. Longer-lived variables also overlap with more other variables, increasing the number of possible interactions an unfamiliar reader has to consider.</p>
<h3 id="dont-store-derived-values">
  
  
    <a href="#dont-store-derived-values" class="anchor-heading">#</a>Don’t Store Derived Values
  
  
</h3>
    

<p>Storing values derived from other values requires careful management of the derived value to ensure it is consistent with the inputs. This is a form of cache invalidation, which is a known <a href="https://martinfowler.com/bliki/TwoHardThings.html">hard thing</a>.</p>

<p>Instead, compute them on the fly when needed by the end consumer. Many languages have good, idiomatic ways to do this, like JavaScript closure-thunks, Java getters, and Python properties.</p>
<h3 id="defer-declarations-as-late-as-possible">
  
  
    <a href="#defer-declarations-as-late-as-possible" class="anchor-heading">#</a>Defer Declarations as Late as Possible
  
  
</h3>
    

<p>A variable declaration is a statement to your reader: “here, keep an eye on this”. If you declare everything up front in your scope, you have maximized the number of possible interactions to consider. If you declare a variable without initializing it, you have most likely put your program into a temporarily-invalid state (that you presumably intend to resolve near-immediately).</p>

<p>Declaring variables closer to where they are used reduces possible interactions and likely gives you the opportunity to provide a useful initialization value.</p>
<h3 id="shorten-lifetimes-with-blocks-or-one-use-functions">
  
  
    <a href="#shorten-lifetimes-with-blocks-or-one-use-functions" class="anchor-heading">#</a>Shorten Lifetimes with Blocks (or One-use Functions)
  
  
</h3>
    

<p>Anonymous scoping blocks (if your language supports it) or one-use functions (otherwise) can be used to move the end of a variable’s lifetime earlier. This complements moving the declaration later to minimize possible interactions with other variables. In cases where several intermediate values are juggled to produce some other value, an anonymous block can ensure those intermediate values can be forgotten about by the reader as soon as the block ends, rather than hang over their head through the rest of the function.</p>

<p>Some languages make this more ergonomic than others. Languages with blocks-as-values are best; languages whose only scope control is functions are acceptable, but one has to get used to the idea of breaking out single-use functions.</p>
<h2 id="mutation-and-side-effects">
  
  
    <a href="#mutation-and-side-effects" class="anchor-heading">#</a>Mutation and Side Effects
  
  
</h2>
    

<p>Try to reduce the number of possible states your program can be in. Ideally, values can be initialized once and never changed.</p>
<h3 id="prefer-constant-variables">
  
  
    <a href="#prefer-constant-variables" class="anchor-heading">#</a>Prefer Constant Variables
  
  
</h3>
    

<p>In languages that support it, declaring variables constant (heh) is recommended in all cases where it’s possible. The majority of modern application glue code is not a performance bottleneck, and making the computer go slightly out of the way to compute and store a series of constants is rarely going to harm scalability.</p>

<p>Constants are both easier for a human to reason about, and may allow compilers and other tools to make optimizations under the hood to reclaim any lost performance. In extreme cases, code without mutation may run faster than faster-looking mutation-based code because optimizations like vectorization become possible.</p>
<h3 id="minimize-mutations-blast-radius">
  
  
    <a href="#minimize-mutations-blast-radius" class="anchor-heading">#</a>Minimize Mutations’ Blast Radius
  
  
</h3>
    

<p>Where mutation cannot be avoided for practical reasons, encapsulate it in a (testable!) implementation where consumers can mostly or entirely ignore the grisly details. In many languages, this is a perfect application of classes, which can hide all intermediate/book-keeping values away from the consumer and only allow known-good operations at the right times. See also: <a href="https://en.wikipedia.org/wiki/State_machine">state machines</a>.</p>

<p>Functional-like programming is increasingly prevalent in historically-imperative languages. This is a Good Thing, and means that classes can be reserved as a signpost saying “here be dragons”, rather than a Java-style code organization catch-all.</p>
<h1 id="types">
  
  
    <a href="#types" class="anchor-heading">#</a>Types
  
  
</h1>
    

<p>This section is general recommendations for types that do not fit in a narrower context.</p>

<p>See also <a href="#use-exhaustiveness-checking">exhaustiveness checking</a>.</p>
<h2 id="enumerations-v-booleans">
  
  
    <a href="#enumerations-v-booleans" class="anchor-heading">#</a>Enumerations v. Booleans
  
  
</h2>
    

<p>Booleans are a two-valued enumeration. Some languages make compilation decisions based on which you choose, but by and large which to use is a stylistic decision.</p>

<p>Nullable booleans should be avoided. They are a three-valued enumeration, where the null value has potentially-unclear or even accidental semantics and depending on the language/database/protocol support for null handling, may be an unnecessary footgun. Consider a user-controlled setting: does null mean “use the default at the time I close the settings page” or “use the default at the time the setting is used”? Instead of answering that question directly, either explicitly default the boolean at write time or define an enumeration with a member called <code class="language-plaintext highlighter-rouge">use_current_default</code> (respectively).</p>

<p>Boolean parameters should be used sparingly, as many call sites with boolean literals are reader-unfriendly. This is extra true if there are multiple boolean parameters.</p>
<h2 id="keyword-arguments">
  
  
    <a href="#keyword-arguments" class="anchor-heading">#</a>Keyword Arguments
  
  
</h2>
    

<p>Functions with many parameters are sometimes unavoidable. Mitigate the readability difficulty and ordering sensitivity by using keyword arguments, so the call sites are clearer to read and easier to write correctly.</p>

<p>In some languages this may require you to define a new type. These types often end up as <a href="https://en.wikipedia.org/wiki/Union_type">union types</a>, since it’s rare that every parameter in a large parameter list is used in every code path, which may point to a beneficial refactor to split the methods or even re-combine the different paths (and corresponding parameters) back together.</p>

<p>Keyword arguments can even amplify the readability of good names where they are not strictly necessary to mitigate large parameter lists, as seen frequently in Swift.</p>
<h1 id="debuggability-and-observability">
  
  
    <a href="#debuggability-and-observability" class="anchor-heading">#</a>Debuggability and Observability
  
  
</h1>
    
<h2 id="string-literal-log-lines">
  
  
    <a href="#string-literal-log-lines" class="anchor-heading">#</a>String Literal Log Lines
  
  
</h2>
    

<p>Log lines should have a (hopefully unique) string literal explaining their purpose. Pass relevant values in a separate parameter.</p>

<p>Interpolating relevant values into the primary log message makes it difficult for a human to quickly grep for the log’s source, introduces unnecessary formatting uncertainty (do you quote string-type values? what if the string has a quote in it? what if your string is the word “null”?) and can make it difficult or impossible for logging tools to extract and search/aggregate on those values.</p>
<h1 id="version-control-ie-git">
  
  
    <a href="#version-control-ie-git" class="anchor-heading">#</a>Version Control (i.e. Git)
  
  
</h1>
    

<p>With apologies to Mercurial, Perforce, Fossil, and (extra apologies) SVN/CVS users.</p>
<h2 id="squash-v-rebase-v-merge-into-mainline">
  
  
    <a href="#squash-v-rebase-v-merge-into-mainline" class="anchor-heading">#</a>Squash v. Rebase v. Merge into Mainline
  
  
</h2>
    

<p>Between squashes and merges I prefer merges, but <em>consistency</em> is more important. If your team uses squashes, you must permit an escape hatch for occasional merges. Rebasing is never correct, both lying about development history while still cluttering it with non-“atomic” commits.</p>

<p>Consistency across the team means I always know where to go to get the development history of a change – either in-repo or the code review tool – and I can write/use automated tooling knowing what to expect. Mixing styles makes every dive into code history an unpleasant surprise.</p>

<p>Squash-based workflows must have an escape hatch for true merges to deal with scripted changes. This is for a few reasons:</p>

<ul>
  <li>The script should <em>always</em> be present in the history nearby the change it made, but it’s likely undesirable to have it in the repo right now.</li>
  <li>The automated changes may be uninteresting for e.g. blame, and Git supports mechanisms to ignore named commits for blames and diffs.</li>
  <li>When debugging the change in the future, it is important to know if the issue originated in automated changes or related manual changes.</li>
</ul>

<p>Squashing fails at all three.</p>
<h2 id="force-pushingrebasing-feature-branches">
  
  
    <a href="#force-pushingrebasing-feature-branches" class="anchor-heading">#</a>Force-pushing/Rebasing Feature Branches
  
  
</h2>
    

<p>Depends on the current state of the code review and quality of the review tools.</p>

<p>If nobody has reviewed your code, force-pushing is acceptable, and possibly even desirable in order to present the best-organized history to the first reviewer(s).</p>

<p>If a review is in progress, force-push only if the review tools support it in a first-class way. At the time of writing GitHub completely shits the bed, losing comments and unsetting review state all over the place, which is a huge waste of time for reviewers. A competitor I have used and like, <a href="https://reviewable.io">Reviewable</a>, supports force-pushes first-class and will show your reviewer the actual diff, even from a commit they saw previously that is no longer on the branch.</p><hr />

<section class="next-previous">
    
    <a href="/yogurt" class="next-previous-link next-previous-previous" title="Previous Post: Yogurt Recipe">
      <span class="next-previous-icon">←</span>
      <div class="next-previous-name">
        <div class="next-previous-label">
          <span class="next-previous-icon">←</span> Previous Post
        </div>
        <div class="next-previous-title">Yogurt Recipe</div>
      </div>
    </a>
     
    <div class="next-previous-placeholder"></div>
    
  </section><hr />

<section class="tag-list">
  <i class="tag-label">tags:</i>
  
  <a class="tag-link" href="/tag/programming">programming</a>,  
  <a class="tag-link" href="/tag/reference">reference</a> 
</section>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Useful cross-language byte-identical find-replace has happened exactly once in my programming life (both professional and personal), but I want this document to be complete, so it’s included. I wanted to find exact matches across JavaScript and JSON files, but JSON only permits double-quotes while JavaScript’s Prettier formatter was configured for single quotes. Notably, the tool with this code was later rewritten to something simpler and more expressive such that maintaining formatting consistency became irrelevant (and impossible), which is the ideal outcome. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>I tried to come up with non <em>-tion</em> words, but those nounified verbs come up all the time! <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
<footer>
    <p class="post-date">
      ~
      <time
        datetime="2025-11-04T00:00:00+00:00"
        itemprop="datePublished"
      >
        2025-11-04
      </time>~
    </p>
  </footer>
</article>

      <!--
        This filthy trick makes sure that the content always weakly tries to expand to the full
        width available, but allows for linebreaks if the viewport is too small. It produces a
        better result than, say, width: 100%; or width: some-fixed-pixel-amount; and doesn't require
        rewriting everything to flexbox (which would mess with the <html>-level scroll behavior and
        sticky header) or adding extra DOM (which I'm trying to minimize to make myself feel good).
      -->
      <div class="horizontal-expander" aria-hidden="true">
        Throughout human history, we have been dependent on machines to survive.
        Fate, it seems, is not without a sense of irony.
      </div>
    </main>
  </body>
  <script src="/assets/js/theme-switcher.js"></script>
  <script src="/assets/js/copy-code-block.js"></script>
  <script src="/assets/js/unit-switcher.js"></script>
  
</html>
